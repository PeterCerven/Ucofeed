<div class="review-form-container" *transloco="let t; prefix 'reviewForm'">
  <h2 class="form-title">{{ t('title') }}</h2>

  <form [formGroup]="reviewForm" (ngSubmit)="onSubmit()" class="review-form">

    <!-- Review Comment -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>{{ t('yourReview') }}</mat-label>
      <textarea
        matInput
        formControlName="comment"
        rows="6"
        [placeholder]="t('commentPlaceholder')"></textarea>
      <mat-hint>
        {{ reviewForm.get('comment')?.value?.length || 0 }} {{ t('charactersMinimum') }}
      </mat-hint>
      @if (reviewForm.get('comment')?.hasError('required') && reviewForm.get('comment')?.touched) {
        <mat-error>{{ t('commentRequired') }}</mat-error>
      }
      @if (reviewForm.get('comment')?.hasError('minlength')) {
        <mat-error>{{ t('commentMinLength') }}</mat-error>
      }
    </mat-form-field>

    <!-- Rating Slider -->
    <div class="rating-section">
      <label class="rating-label">
        {{ t('overallRating') }} <strong>{{ reviewForm.get('rating')?.value || 1 }}/10</strong>
      </label>
      <mat-slider
        min="1"
        max="10"
        step="1"
        showTickMarks
        discrete
        class="full-width">
        <input matSliderThumb formControlName="rating" />
      </mat-slider>
      <div class="rating-stars">
        @for (star of ratingStars(); track $index) {
          <mat-icon [class.filled]="star" class="star-icon">
            {{ star ? 'star' : 'star_border' }}
          </mat-icon>
        }
      </div>
    </div>

    <!-- Anonymous Checkbox -->
    <div class="anonymous-section">
      <mat-checkbox formControlName="anonymous">
        {{ t('anonymousCheckbox') }}
      </mat-checkbox>
      <span class="anonymous-hint">{{ t('anonymousHint') }}</span>
    </div>

    <!-- Action Buttons -->
    <div class="form-actions">
      <button
        mat-raised-button
        type="button"
        (click)="onCancel()">
        {{ t('cancel') }}
      </button>
      <button
        mat-raised-button
        color="primary"
        type="submit"
        [disabled]="reviewForm.invalid || isSubmitting()">
        @if (isSubmitting()) {
          <ng-container>
            <mat-icon>hourglass_empty</mat-icon> {{ t('submitting') }}
          </ng-container>
        } @else {
          {{ t('submit') }}
        }
      </button>
    </div>
  </form>
</div>
